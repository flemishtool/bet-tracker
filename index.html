<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#0f0f1a">
    <title>21-Day Betting Challenge</title>
    
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üéØ</text></svg>">
    
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-primary: #0f0f1a;
            --bg-secondary: #1a1a2e;
            --bg-tertiary: #252542;
            --accent-green: #00d4aa;
            --accent-orange: #ff9f43;
            --accent-red: #ff6b6b;
            --accent-blue: #54a0ff;
            --accent-purple: #a55eea;
            --accent-yellow: #feca57;
            --accent-cyan: #00cec9;
            --text-primary: #ffffff;
            --text-secondary: #a0a0b8;
            --text-muted: #6c6c8a;
            --border-color: #2d2d4a;
        }

        [data-theme="light"] {
            --bg-primary: #f5f7fa;
            --bg-secondary: #ffffff;
            --bg-tertiary: #e8ecf1;
            --text-primary: #1a1a2e;
            --text-secondary: #5a5a7a;
            --text-muted: #8a8aa8;
            --border-color: #d0d5dd;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .app-container { display: flex; min-height: 100vh; }
        .main-content { flex: 1; padding: 12px; padding-bottom: 80px; overflow-x: hidden; }

        .betslip-sidebar {
            width: 340px;
            background: var(--bg-secondary);
            border-left: 1px solid var(--border-color);
            padding: 12px;
            position: fixed;
            right: 0; top: 0; bottom: 0;
            overflow-y: auto;
            z-index: 50;
            display: none;
        }

        @media (min-width: 1200px) {
            .main-content { margin-right: 340px; padding-bottom: 20px; }
            .betslip-sidebar { display: block; }
            .betslip-mobile-toggle, .betslip-mobile-panel { display: none !important; }
        }

        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 2px solid var(--border-color);
            margin-bottom: 15px;
            flex-wrap: wrap;
            gap: 12px;
        }

        .header-left { display: flex; align-items: center; gap: 12px; flex-wrap: wrap; }

        .header h1 {
            font-size: 1.2rem;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .header-controls { display: flex; align-items: center; gap: 8px; }

        .status-badge {
            display: flex;
            align-items: center;
            gap: 5px;
            padding: 4px 10px;
            background: var(--bg-tertiary);
            border-radius: 15px;
            font-size: 0.65rem;
        }

        .status-dot { width: 7px; height: 7px; border-radius: 50%; }
        .status-dot.online { background: var(--accent-green); }
        .status-dot.connecting { background: var(--accent-orange); animation: pulse 1s infinite; }
        .status-dot.offline { background: var(--accent-red); }

        .theme-toggle {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 15px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 0.9rem;
            color: var(--text-primary);
        }

        .header-stats { display: flex; gap: 12px; flex-wrap: wrap; }
        .header-stat { text-align: center; }
        .header-stat-value { font-size: 0.95rem; font-weight: bold; color: var(--accent-green); }
        .header-stat-label { font-size: 0.5rem; color: var(--text-secondary); text-transform: uppercase; }

        .quick-stats {
            display: flex;
            gap: 6px;
            margin-bottom: 12px;
            overflow-x: auto;
            padding-bottom: 6px;
        }

        .quick-stat {
            background: var(--bg-secondary);
            padding: 8px 12px;
            border-radius: 8px;
            text-align: center;
            min-width: 80px;
            flex-shrink: 0;
            border: 1px solid var(--border-color);
        }

        .quick-stat-value { font-size: 0.9rem; font-weight: bold; }
        .quick-stat-label { font-size: 0.5rem; color: var(--text-secondary); text-transform: uppercase; margin-top: 2px; }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
            gap: 10px;
        }

        @media (max-width: 768px) { .grid { grid-template-columns: 1fr; } }

        .card {
            background: var(--bg-secondary);
            border-radius: 10px;
            padding: 12px;
            border: 1px solid var(--border-color);
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border-color);
            flex-wrap: wrap;
            gap: 6px;
        }

        .card-title { font-size: 0.85rem; font-weight: 600; display: flex; align-items: center; gap: 6px; }
        .card-actions { display: flex; gap: 6px; align-items: center; }
        .card.full-width { grid-column: 1 / -1; }

        .filters-bar {
            display: flex;
            gap: 6px;
            margin-bottom: 10px;
            flex-wrap: wrap;
            align-items: center;
            padding: 8px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            font-size: 0.7rem;
        }

        .filter-group { display: flex; align-items: center; gap: 4px; }
        .filter-label { font-size: 0.55rem; color: var(--text-secondary); text-transform: uppercase; }

        .filter-input, .filter-select, .date-input {
            padding: 5px 8px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 0.7rem;
        }

        .date-input::-webkit-calendar-picker-indicator { filter: invert(1); cursor: pointer; }
        [data-theme="light"] .date-input::-webkit-calendar-picker-indicator { filter: none; }

        .tabs { display: flex; gap: 4px; overflow-x: auto; padding: 3px 0; margin-bottom: 8px; }
        .tabs::-webkit-scrollbar { height: 2px; }

        .tab {
            padding: 5px 10px;
            background: var(--bg-tertiary);
            border: 1px solid var(--border-color);
            border-radius: 5px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.65rem;
            white-space: nowrap;
            flex-shrink: 0;
        }

        .tab:hover { background: var(--border-color); }
        .tab.active { background: var(--accent-green); color: var(--bg-primary); border-color: var(--accent-green); }

        .fixtures-container { max-height: 500px; overflow-y: auto; }

        .fixture-card {
            background: var(--bg-tertiary);
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 8px;
            border: 2px solid transparent;
            transition: all 0.2s;
        }

        .fixture-card:hover { border-color: var(--accent-blue); }
        .fixture-card.selected { border-color: var(--accent-orange); background: rgba(255, 159, 67, 0.1); }

        .fixture-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .fixture-league { font-size: 0.6rem; color: var(--accent-blue); font-weight: 600; }
        .fixture-time { font-size: 0.65rem; color: var(--text-secondary); background: var(--bg-secondary); padding: 2px 6px; border-radius: 3px; }
        .fixture-time.live { background: var(--accent-red); color: white; }

        .fixture-teams { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .fixture-team { display: flex; align-items: center; gap: 6px; flex: 1; min-width: 0; }
        .fixture-team.away { flex-direction: row-reverse; text-align: right; }
        .team-logo { width: 24px; height: 24px; border-radius: 4px; object-fit: contain; background: var(--bg-secondary); }
        .team-name { font-size: 0.8rem; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .fixture-vs { font-size: 0.7rem; color: var(--text-muted); padding: 0 10px; }
        .fixture-score { font-size: 1rem; font-weight: bold; padding: 0 10px; color: var(--accent-green); }

        .odds-section { margin-top: 8px; }
        .odds-section-title { font-size: 0.5rem; color: var(--text-muted); text-transform: uppercase; margin-bottom: 4px; }
        .odds-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 4px; }
        .odds-grid.grid-2 { grid-template-columns: repeat(2, 1fr); }
        .odds-grid.grid-4 { grid-template-columns: repeat(4, 1fr); }
        .odds-grid.grid-5 { grid-template-columns: repeat(5, 1fr); }

        .odd-btn {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            padding: 5px 3px;
            text-align: center;
            cursor: pointer;
            transition: all 0.15s;
        }

        .odd-btn:hover { border-color: var(--accent-green); background: rgba(0, 212, 170, 0.1); }
        .odd-btn.selected { background: var(--accent-green); border-color: var(--accent-green); color: var(--bg-primary); }
        .odd-label { font-size: 0.45rem; color: var(--text-secondary); }
        .odd-btn.selected .odd-label { color: var(--bg-primary); }
        .odd-value { font-size: 0.75rem; font-weight: bold; }
        .bookmaker-tag { font-size: 0.45rem; color: var(--text-muted); text-align: right; margin-top: 4px; }

        .load-odds-btn {
            width: 100%;
            margin-top: 6px;
            padding: 6px;
            background: var(--bg-secondary);
            border: 1px dashed var(--border-color);
            border-radius: 4px;
            color: var(--text-secondary);
            cursor: pointer;
            font-size: 0.7rem;
        }

        .load-odds-btn:hover { border-color: var(--accent-green); color: var(--accent-green); }

        .betslip-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 12px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--accent-green);
        }

        .betslip-title { font-size: 0.9rem; font-weight: 600; }
        .betslip-count { background: var(--accent-green); color: var(--bg-primary); padding: 2px 8px; border-radius: 10px; font-size: 0.7rem; margin-left: 6px; }
        .betslip-clear { color: var(--accent-red); cursor: pointer; font-size: 0.7rem; }
        .betslip-empty { text-align: center; padding: 30px; color: var(--text-secondary); }
        .betslip-empty-icon { font-size: 2rem; margin-bottom: 10px; opacity: 0.5; }

        .betslip-leg {
            background: var(--bg-tertiary);
            border-radius: 6px;
            padding: 8px;
            margin-bottom: 6px;
            position: relative;
        }

        .betslip-leg-remove {
            position: absolute;
            top: 6px; right: 6px;
            background: var(--accent-red);
            border: none;
            border-radius: 50%;
            width: 16px; height: 16px;
            color: white;
            cursor: pointer;
            font-size: 0.6rem;
        }

        .betslip-leg-match { font-size: 0.6rem; color: var(--text-secondary); margin-bottom: 2px; padding-right: 20px; }
        .betslip-leg-selection { font-size: 0.75rem; font-weight: 600; margin-bottom: 3px; }

        .betslip-leg-odds-input {
            width: 55px;
            padding: 3px 5px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--accent-green);
            font-weight: bold;
            font-size: 0.75rem;
            text-align: center;
        }

        .betslip-summary { background: var(--bg-tertiary); border-radius: 8px; padding: 10px; margin-top: 10px; }
        .betslip-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 5px; font-size: 0.75rem; }
        .betslip-row.total { font-weight: bold; margin-top: 8px; padding-top: 8px; border-top: 1px solid var(--border-color); }

        .betslip-stake-input {
            width: 80px;
            padding: 5px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 4px;
            color: var(--text-primary);
            font-size: 0.8rem;
            text-align: right;
        }

        .stake-presets { display: flex; gap: 3px; margin-top: 6px; }
        .stake-preset {
            flex: 1;
            padding: 3px;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 3px;
            color: var(--text-secondary);
            font-size: 0.55rem;
            cursor: pointer;
            text-align: center;
        }
        .stake-preset:hover { border-color: var(--accent-green); color: var(--accent-green); }

        .confidence-options { display: flex; gap: 4px; margin-top: 8px; }
        .conf-btn {
            flex: 1;
            padding: 5px;
            border: 1px solid var(--border-color);
            border-radius: 4px;
            background: var(--bg-secondary);
            color: var(--text-secondary);
            font-size: 0.6rem;
            cursor: pointer;
            text-align: center;
        }
        .conf-btn.active.low { border-color: var(--accent-red); color: var(--accent-red); }
        .conf-btn.active.med { border-color: var(--accent-orange); color: var(--accent-orange); }
        .conf-btn.active.high { border-color: var(--accent-green); color: var(--accent-green); }

        .betslip-submit {
            width: 100%;
            padding: 10px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            border: none;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            font-size: 0.85rem;
            cursor: pointer;
            margin-top: 8px;
        }

        .betslip-submit:disabled { opacity: 0.5; cursor: not-allowed; }

        .betslip-mobile-toggle {
            position: fixed;
            bottom: 15px; right: 15px;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            color: white;
            border: none;
            border-radius: 25px;
            padding: 10px 18px;
            font-weight: bold;
            cursor: pointer;
            z-index: 100;
            display: flex;
            align-items: center;
            gap: 6px;
            box-shadow: 0 4px 15px rgba(0, 212, 170, 0.4);
            font-size: 0.8rem;
        }

        .betslip-mobile-toggle .count {
            background: white;
            color: var(--bg-primary);
            border-radius: 50%;
            width: 20px; height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7rem;
        }

        .betslip-mobile-panel {
            position: fixed;
            bottom: 0; left: 0; right: 0;
            background: var(--bg-secondary);
            border-top: 2px solid var(--accent-green);
            padding: 12px;
            z-index: 99;
            transform: translateY(100%);
            transition: transform 0.3s;
            max-height: 70vh;
            overflow-y: auto;
            border-radius: 15px 15px 0 0;
        }

        .betslip-mobile-panel.open { transform: translateY(0); }

        .progress-bar { height: 20px; background: var(--bg-tertiary); border-radius: 10px; overflow: hidden; margin: 10px 0; }
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--accent-green), var(--accent-blue));
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.65rem;
            font-weight: bold;
            min-width: 40px;
        }

        .streak-grid { display: flex; gap: 3px; flex-wrap: wrap; margin: 10px 0; }
        .streak-day {
            width: 22px; height: 22px;
            border-radius: 4px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.55rem;
            font-weight: bold;
        }
        .streak-won { background: var(--accent-green); color: var(--bg-primary); }
        .streak-lost { background: var(--accent-red); color: white; }
        .streak-pending { background: var(--bg-tertiary); color: var(--text-muted); border: 1px dashed var(--border-color); }
        .streak-current { border: 2px solid white !important; box-shadow: 0 0 8px rgba(255,255,255,0.3); }

        .metrics-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .metric-box { background: var(--bg-tertiary); padding: 10px; border-radius: 6px; text-align: center; }
        .metric-value { font-size: 1.1rem; font-weight: bold; }
        .metric-label { font-size: 0.5rem; color: var(--text-secondary); text-transform: uppercase; }

        .strategy-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 8px; }
        .strategy-item { background: var(--bg-tertiary); padding: 10px; border-radius: 6px; text-align: center; }
        .strategy-value { font-size: 1rem; font-weight: bold; }
        .strategy-label { font-size: 0.5rem; color: var(--text-secondary); text-transform: uppercase; }

        .strategy-tip {
            background: rgba(0, 212, 170, 0.1);
            border: 1px solid var(--accent-green);
            border-radius: 6px;
            padding: 10px;
            margin-top: 10px;
            font-size: 0.7rem;
        }
        .strategy-tip-title { color: var(--accent-green); font-weight: 600; margin-bottom: 4px; font-size: 0.65rem; }

        .milestones-list { max-height: 250px; overflow-y: auto; }
        .milestone-item {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 8px;
            background: var(--bg-tertiary);
            border-radius: 6px;
            margin-bottom: 5px;
        }
        .milestone-item.reached { background: rgba(0, 212, 170, 0.15); border: 1px solid var(--accent-green); }
        .milestone-check {
            width: 24px; height: 24px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.6rem;
        }
        .milestone-check.pending { background: var(--bg-secondary); color: var(--text-muted); border: 1px dashed var(--border-color); }
        .milestone-check.reached { background: var(--accent-green); color: var(--bg-primary); }
        .milestone-amount { font-weight: bold; font-size: 0.8rem; }
        .milestone-label { font-size: 0.55rem; color: var(--text-secondary); }

        .targets-list { max-height: 200px; overflow-y: auto; }
        .target-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 8px;
            background: var(--bg-tertiary);
            border-radius: 4px;
            margin-bottom: 4px;
            font-size: 0.7rem;
        }
        .target-row.current { border: 1px solid var(--accent-orange); }

        .probability-display { text-align: center; padding: 15px; }
        .probability-value {
            font-size: 2rem;
            font-weight: bold;
            background: linear-gradient(135deg, var(--accent-green), var(--accent-blue));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        .probability-label { font-size: 0.65rem; color: var(--text-secondary); }

        .prob-stats { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; margin-top: 10px; }
        .prob-stat { background: var(--bg-tertiary); padding: 8px; border-radius: 6px; text-align: center; }
        .prob-stat-value { font-size: 0.9rem; font-weight: bold; }
        .prob-stat-label { font-size: 0.45rem; color: var(--text-secondary); text-transform: uppercase; }

        .risk-bar { height: 8px; background: linear-gradient(90deg, var(--accent-green), var(--accent-yellow), var(--accent-orange), var(--accent-red)); border-radius: 4px; position: relative; margin: 15px 0 5px; }
        .risk-indicator { position: absolute; top: -4px; width: 14px; height: 14px; background: white; border-radius: 50%; border: 2px solid var(--bg-primary); transform: translateX(-50%); box-shadow: 0 2px 5px rgba(0,0,0,0.3); }

        .analytics-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 6px; }
        .analytics-item { background: var(--bg-tertiary); padding: 8px; border-radius: 6px; }
        .analytics-label { font-size: 0.5rem; color: var(--text-secondary); text-transform: uppercase; }
        .analytics-value { font-size: 0.85rem; font-weight: bold; }

        .market-stats { margin-top: 10px; }
        .market-row { display: flex; align-items: center; gap: 6px; padding: 4px 0; border-bottom: 1px solid var(--border-color); font-size: 0.65rem; }
        .market-name { flex: 1; }
        .market-bar { flex: 2; height: 5px; background: var(--bg-secondary); border-radius: 2px; overflow: hidden; }
        .market-bar-fill { height: 100%; border-radius: 2px; }
        .market-stat { min-width: 35px; text-align: right; font-weight: bold; }

        .day-perf { display: flex; gap: 3px; margin-top: 10px; align-items: flex-end; height: 60px; }
        .day-bar-wrap { flex: 1; display: flex; flex-direction: column; align-items: center; gap: 2px; }
        .day-bar { width: 100%; background: var(--bg-secondary); border-radius: 2px; position: relative; min-height: 3px; }
        .day-bar-fill { position: absolute; bottom: 0; left: 0; right: 0; border-radius: 2px; }
        .day-bar-label { font-size: 0.4rem; color: var(--text-muted); }

        .pending-bet { background: var(--bg-tertiary); border-radius: 8px; padding: 10px; margin-bottom: 8px; }
        .pending-header { display: flex; justify-content: space-between; margin-bottom: 6px; }
        .pending-leg { padding: 4px 0; border-bottom: 1px solid var(--border-color); font-size: 0.7rem; }
        .pending-leg:last-child { border-bottom: none; }
        .pending-summary { display: flex; justify-content: space-between; font-size: 0.7rem; margin-top: 6px; padding-top: 6px; border-top: 1px solid var(--border-color); }

        .btn {
            padding: 6px 12px;
            border: none;
            border-radius: 5px;
            font-size: 0.7rem;
            font-weight: 600;
            cursor: pointer;
        }
        .btn-primary { background: linear-gradient(135deg, var(--accent-green), var(--accent-blue)); color: white; }
        .btn-secondary { background: var(--bg-tertiary); color: var(--text-primary); border: 1px solid var(--border-color); }
        .btn-success { background: var(--accent-green); color: var(--bg-primary); }
        .btn-danger { background: var(--accent-red); color: white; }
        .btn-sm { padding: 4px 8px; font-size: 0.65rem; }
        .btn-group { display: flex; gap: 5px; margin-top: 6px; }
        .btn-group .btn { flex: 1; }

        .modal-overlay {
            position: fixed;
            top: 0; left: 0; right: 0; bottom: 0;
            background: rgba(0, 0, 0, 0.85);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 200;
            padding: 15px;
        }
        .modal-overlay.open { display: flex; }
        .modal { background: var(--bg-secondary); border-radius: 12px; padding: 15px; max-width: 400px; width: 100%; max-height: 80vh; overflow-y: auto; }
        .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; padding-bottom: 10px; border-bottom: 1px solid var(--border-color); }
        .modal-title { font-size: 1rem; font-weight: 600; }
        .modal-close { background: none; border: none; color: var(--text-secondary); font-size: 1.3rem; cursor: pointer; }

        .form-group { margin-bottom: 10px; }
        .form-label { display: block; font-size: 0.7rem; color: var(--text-secondary); margin-bottom: 4px; }
        .form-input { width: 100%; padding: 8px 10px; background: var(--bg-tertiary); border: 1px solid var(--border-color); border-radius: 6px; color: var(--text-primary); font-size: 0.8rem; }

        .table-container { overflow-x: auto; max-height: 300px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 8px 5px; text-align: left; font-size: 0.6rem; border-bottom: 1px solid var(--border-color); }
        th { background: var(--bg-tertiary); font-size: 0.5rem; text-transform: uppercase; color: var(--text-secondary); position: sticky; top: 0; }

        .badge { padding: 2px 6px; border-radius: 8px; font-size: 0.5rem; font-weight: 600; text-transform: uppercase; }
        .badge-pending { background: rgba(255, 159, 67, 0.2); color: var(--accent-orange); }
        .badge-won { background: rgba(0, 212, 170, 0.2); color: var(--accent-green); }
        .badge-lost { background: rgba(255, 107, 107, 0.2); color: var(--accent-red); }
        .badge-low { background: rgba(255, 107, 107, 0.2); color: var(--accent-red); }
        .badge-med { background: rgba(255, 159, 67, 0.2); color: var(--accent-orange); }
        .badge-high { background: rgba(0, 212, 170, 0.2); color: var(--accent-green); }

        .chart-container { height: 160px; }

        .green { color: var(--accent-green); }
        .red { color: var(--accent-red); }
        .orange { color: var(--accent-orange); }
        .blue { color: var(--accent-blue); }
        .text-muted { color: var(--text-muted); }
        .mt-1 { margin-top: 6px; }

        .empty-state { text-align: center; padding: 20px; color: var(--text-secondary); }
        .empty-state-icon { font-size: 2rem; margin-bottom: 8px; opacity: 0.5; }

        .loading { display: flex; justify-content: center; align-items: center; padding: 30px; }
        .spinner { width: 30px; height: 30px; border: 3px solid var(--bg-tertiary); border-top-color: var(--accent-green); border-radius: 50%; animation: spin 1s linear infinite; }

        @keyframes spin { to { transform: rotate(360deg); } }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }

        .notification {
            position: fixed;
            top: 10px; left: 10px; right: 10px;
            padding: 10px 14px;
            border-radius: 8px;
            color: white;
            font-weight: 600;
            z-index: 300;
            font-size: 0.75rem;
            text-align: center;
            animation: slideDown 0.3s;
        }
        @keyframes slideDown { from { transform: translateY(-100%); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .notification-success { background: var(--accent-green); color: var(--bg-primary); }
        .notification-error { background: var(--accent-red); }
        .notification-warning { background: var(--accent-orange); color: var(--bg-primary); }
        .notification-info { background: var(--accent-blue); }

        ::-webkit-scrollbar { width: 4px; height: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--border-color); border-radius: 2px; }

        @media (max-width: 768px) {
            .header { flex-direction: column; text-align: center; }
            .filters-bar { flex-direction: column; align-items: stretch; }
        }
    </style>
</head>
<body>
    <div class="app-container">
        <div class="main-content">
            <div class="header">
                <div class="header-left">
                    <h1>üéØ 21-Day Challenge</h1>
                    <div class="header-controls">
                        <div class="status-badge">
                            <div class="status-dot connecting" id="fbDot"></div>
                            <span id="fbText">Connecting</span>
                        </div>
                        <div class="status-badge">
                            <div class="status-dot" id="apiDot"></div>
                            <span id="apiText">API</span>
                        </div>
                        <button class="theme-toggle" onclick="toggleTheme()" id="themeBtn">üåô</button>
                    </div>
                </div>
                <div class="header-stats">
                    <div class="header-stat"><div class="header-stat-value" id="hDay">Day 3</div><div class="header-stat-label">Day</div></div>
                    <div class="header-stat"><div class="header-stat-value" id="hBal">¬£384</div><div class="header-stat-label">Balance</div></div>
                    <div class="header-stat"><div class="header-stat-value green" id="hWin">100%</div><div class="header-stat-label">Win Rate</div></div>
                    <div class="header-stat"><div class="header-stat-value" id="hStat">üü¢</div><div class="header-stat-label">Status</div></div>
                </div>
            </div>

            <div class="quick-stats">
                <div class="quick-stat"><div class="quick-stat-value green" id="qProf">¬£184</div><div class="quick-stat-label">Profit</div></div>
                <div class="quick-stat"><div class="quick-stat-value blue" id="qTarg">¬£346</div><div class="quick-stat-label">Target</div></div>
                <div class="quick-stat"><div class="quick-stat-value orange" id="qVs">+¬£38</div><div class="quick-stat-label">vs Target</div></div>
                <div class="quick-stat"><div class="quick-stat-value" id="qOdds">1.39</div><div class="quick-stat-label">Avg Odds</div></div>
                <div class="quick-stat"><div class="quick-stat-value" id="qLeft">19</div><div class="quick-stat-label">Days Left</div></div>
                <div class="quick-stat"><div class="quick-stat-value" id="qROI">92%</div><div class="quick-stat-label">ROI</div></div>
            </div>

            <div class="grid">
                <!-- Fixtures -->
                <div class="card">
                    <div class="card-header">
                        <span class="card-title">‚öΩ Fixtures</span>
                        <div class="card-actions">
                            <span class="text-muted" id="fixCount">0</span>
                            <button class="btn btn-sm btn-secondary" onclick="loadFixtures()">üîÑ</button>
                        </div>
                    </div>
                    <div class="filters-bar">
                        <div class="filter-group">
                            <span class="filter-label">Date:</span>
                            <input type="date" class="date-input" id="dateF">
                            <button class="btn btn-sm btn-primary" onclick="loadForDate()">Go</button>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Status:</span>
                            <select class="filter-select" id="statusF" onchange="filterFix()">
                                <option value="all">All</option>
                                <option value="upcoming" selected>Upcoming</option>
                                <option value="live">Live</option>
                                <option value="finished">Finished</option>
                            </select>
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Odds:</span>
                            <input type="number" class="filter-input" id="minO" placeholder="Min" step="0.1" style="width:50px" onchange="filterFix()">
                            <input type="number" class="filter-input" id="maxO" placeholder="Max" step="0.1" style="width:50px" onchange="filterFix()">
                        </div>
                        <div class="filter-group">
                            <span class="filter-label">Sort:</span>
                            <select class="filter-select" id="sortF" onchange="filterFix()">
                                <option value="time">Time</option>
                                <option value="oddsLow">Odds ‚Üë</option>
                                <option value="oddsHigh">Odds ‚Üì</option>
                                <option value="league">League</option>
                            </select>
                        </div>
                        <button class="btn btn-sm btn-secondary" onclick="clearFilt()">Clear</button>
                    </div>
                    <div class="tabs" id="tabs"></div>
                    <div class="fixtures-container" id="fixCont"><div class="loading"><div class="spinner"></div></div></div>
                </div>

                <!-- Progress -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üìà Progress</span></div>
                    <div style="display:flex;justify-content:space-between;font-size:0.7rem;margin-bottom:5px;">
                        <span>Progress to ¬£9,201</span>
                        <span class="green" id="progPct">4.2%</span>
                    </div>
                    <div class="progress-bar"><div class="progress-fill" id="progFill" style="width:4.2%">4.2%</div></div>
                    <div class="streak-grid" id="streak"></div>
                    <div class="metrics-grid">
                        <div class="metric-box"><div class="metric-value green" id="mWin">2</div><div class="metric-label">Wins</div></div>
                        <div class="metric-box"><div class="metric-value red" id="mLoss">0</div><div class="metric-label">Losses</div></div>
                        <div class="metric-box"><div class="metric-value blue" id="mBest">Day 2</div><div class="metric-label">Best Day</div></div>
                        <div class="metric-box"><div class="metric-value orange" id="mStrk">2</div><div class="metric-label">Streak</div></div>
                    </div>
                </div>

                <!-- Pending -->
                <div class="card">
                    <div class="card-header"><span class="card-title">‚è≥ Pending Bets</span></div>
                    <div id="pendCont"><div class="empty-state"><div class="empty-state-icon">üì≠</div><p>No pending bets</p></div></div>
                </div>

                <!-- Strategy -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üéØ Strategy</span></div>
                    <div class="strategy-grid">
                        <div class="strategy-item"><div class="strategy-value green" id="sStake">¬£384</div><div class="strategy-label">Stake</div></div>
                        <div class="strategy-item"><div class="strategy-value blue" id="sOdds">1.20</div><div class="strategy-label">Min Odds</div></div>
                        <div class="strategy-item"><div class="strategy-value orange" id="sTarg">¬£461</div><div class="strategy-label">Target</div></div>
                        <div class="strategy-item"><div class="strategy-value" id="sProf">¬£77</div><div class="strategy-label">Need</div></div>
                    </div>
                    <div class="strategy-tip">
                        <div class="strategy-tip-title">üí° Tip</div>
                        <div id="sTip">Look for safe picks at 1.25-1.35 odds.</div>
                    </div>
                </div>

                <!-- Milestones -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üèÜ Milestones</span></div>
                    <div class="milestones-list" id="miles"></div>
                </div>

                <!-- Targets -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üéØ Targets</span></div>
                    <div class="targets-list" id="targs"></div>
                </div>

                <!-- Probability -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üìä Probability</span></div>
                    <div class="probability-display">
                        <div class="probability-value" id="prob">2.8%</div>
                        <div class="probability-label">Success chance</div>
                    </div>
                    <div class="prob-stats">
                        <div class="prob-stat"><div class="prob-stat-value" id="pLeft">19</div><div class="prob-stat-label">Bets Left</div></div>
                        <div class="prob-stat"><div class="prob-stat-value" id="pNeed">100%</div><div class="prob-stat-label">Wins Needed</div></div>
                        <div class="prob-stat"><div class="prob-stat-value" id="pImpl">83%</div><div class="prob-stat-label">Implied @1.20</div></div>
                        <div class="prob-stat"><div class="prob-stat-value" id="pKelly">Full</div><div class="prob-stat-label">Kelly</div></div>
                    </div>
                    <div class="risk-bar"><div class="risk-indicator" id="riskInd" style="left:70%"></div></div>
                    <div style="display:flex;justify-content:space-between;font-size:0.45rem;color:var(--text-muted);margin-top:3px;"><span>Low</span><span>Med</span><span>High</span><span>Extreme</span></div>
                </div>

                <!-- Analytics -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üìâ Analytics</span></div>
                    <div class="analytics-grid">
                        <div class="analytics-item"><div class="analytics-label">ROI</div><div class="analytics-value green" id="aROI">92%</div></div>
                        <div class="analytics-item"><div class="analytics-label">Avg Stake</div><div class="analytics-value" id="aStake">¬£229</div></div>
                        <div class="analytics-item"><div class="analytics-label">Best Market</div><div class="analytics-value" id="aMkt">Home Win</div></div>
                        <div class="analytics-item"><div class="analytics-label">Best Comp</div><div class="analytics-value" id="aComp">EFL Cup</div></div>
                        <div class="analytics-item"><div class="analytics-label">High Conf</div><div class="analytics-value" id="aConf">100%</div></div>
                        <div class="analytics-item"><div class="analytics-label">Opt Odds</div><div class="analytics-value" id="aOdds">1.20-1.50</div></div>
                    </div>
                    <div class="market-stats" id="mktStats"></div>
                    <div class="day-perf" id="dayPerf"></div>
                </div>

                <!-- Chart -->
                <div class="card">
                    <div class="card-header"><span class="card-title">üìà Chart</span></div>
                    <div class="chart-container"><canvas id="chart"></canvas></div>
                </div>

                <!-- History -->
                <div class="card full-width">
                    <div class="card-header">
                        <span class="card-title">üìú History</span>
                        <div class="card-actions">
                            <button class="btn btn-sm btn-secondary" onclick="exportD()">Export</button>
                            <button class="btn btn-sm btn-secondary" onclick="document.getElementById('impF').click()">Import</button>
                            <input type="file" id="impF" accept=".json" style="display:none" onchange="importD(event)">
                            <button class="btn btn-sm btn-danger" onclick="resetD()">Reset</button>
                        </div>
                    </div>
                    <div class="table-container">
                        <table>
                            <thead><tr><th>Day</th><th>Date</th><th>Selection</th><th>Type</th><th>Conf</th><th>Odds</th><th>Stake</th><th>Result</th><th>Return</th><th>Balance</th><th>vs Targ</th></tr></thead>
                            <tbody id="histBody"></tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <!-- Betslip Sidebar -->
        <div class="betslip-sidebar">
            <div class="betslip-header">
                <span class="betslip-title">üé´ Betslip<span class="betslip-count" id="dCnt">0</span></span>
                <span class="betslip-clear" onclick="clearSlip()">Clear</span>
            </div>
            <div id="dSlip"></div>
        </div>
    </div>

    <button class="betslip-mobile-toggle" onclick="toggleMSlip()">üé´<span class="count" id="mCnt">0</span></button>

    <div class="betslip-mobile-panel" id="mPanel">
        <div class="betslip-header">
            <span class="betslip-title">üé´ Betslip<span class="betslip-count" id="mCntIn">0</span></span>
            <span class="betslip-clear" onclick="clearSlip()">Clear</span>
        </div>
        <div id="mSlip"></div>
    </div>

    <div class="modal-overlay" id="resModal">
        <div class="modal">
            <div class="modal-header">
                <span class="modal-title">Record Result</span>
                <button class="modal-close" onclick="closeRes()">&times;</button>
            </div>
            <div id="modDet"></div>
            <div class="form-group">
                <label class="form-label">Final Score</label>
                <input type="text" class="form-input" id="modScore" placeholder="e.g., 2-1">
            </div>
            <div class="btn-group">
                <button class="btn btn-success" onclick="recRes('won')">‚úÖ Won</button>
                <button class="btn btn-danger" onclick="recRes('lost')">‚ùå Lost</button>
            </div>
            <button class="btn btn-secondary mt-1" onclick="recRes('void')" style="width:100%">‚ö™ Void</button>
        </div>
    </div>

    <script>
        // Config
        const FB_CFG = {apiKey:"AIzaSyD-MH_oSRLM53UHe2sPB4bXRjsEcXEm9IM",authDomain:"bet-tracker-d819b.firebaseapp.com",databaseURL:"https://bet-tracker-d819b-default-rtdb.europe-west1.firebasedatabase.app",projectId:"bet-tracker-d819b",storageBucket:"bet-tracker-d819b.firebasestorage.app",messagingSenderId:"556598232550",appId:"1:556598232550:web:2921e82966b16bf7520227"};
        const API_KEY = '89d2f65b7dc64f8d0fce8468e2a8af2b';
        const API_BASE = 'https://v3.football.api-sports.io';
        const INIT_BAL = 200, MULT = 1.20, DAYS = 21;
        const FINAL = INIT_BAL * Math.pow(MULT, DAYS);
        const MILES = [{a:250,l:'First Profit',e:'üå±'},{a:500,l:'500 Club',e:'üí´'},{a:1000,l:'1K Club',e:'üéØ'},{a:2000,l:'2K',e:'üî•'},{a:3000,l:'3K',e:'‚ö°'},{a:5000,l:'5K',e:'üöÄ'},{a:7500,l:'7.5K',e:'üåü'},{a:9201,l:'Complete!',e:'üèÜ'}];
        const LEAGUES = {39:{n:'Premier League',s:'EPL',f:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',p:1},40:{n:'Championship',s:'Champ',f:'üè¥Û†ÅßÛ†Å¢Û†Å•Û†ÅÆÛ†ÅßÛ†Åø',p:6},45:{n:'FA Cup',s:'FA',f:'üèÜ',p:25},48:{n:'EFL Cup',s:'EFL',f:'üèÜ',p:26},140:{n:'La Liga',s:'LaLiga',f:'üá™üá∏',p:2},143:{n:'Copa del Rey',s:'Copa',f:'üèÜ',p:27},78:{n:'Bundesliga',s:'Bund',f:'üá©üá™',p:3},81:{n:'DFB Pokal',s:'DFB',f:'üèÜ',p:28},135:{n:'Serie A',s:'SerieA',f:'üáÆüáπ',p:4},137:{n:'Coppa Italia',s:'Coppa',f:'üèÜ',p:29},61:{n:'Ligue 1',s:'L1',f:'üá´üá∑',p:5},94:{n:'Primeira Liga',s:'PT',f:'üáµüáπ',p:11},88:{n:'Eredivisie',s:'Ere',f:'üá≥üá±',p:12},144:{n:'Jupiler',s:'BEL',f:'üáßüá™',p:13},203:{n:'S√ºper Lig',s:'TUR',f:'üáπüá∑',p:14},179:{n:'SPFL',s:'SCO',f:'üè¥Û†ÅßÛ†Å¢Û†Å≥Û†Å£Û†Å¥Û†Åø',p:15},307:{n:'Saudi Pro',s:'SAU',f:'üá∏üá¶',p:22},2:{n:'UCL',s:'UCL',f:'üèÜ',p:40},3:{n:'UEL',s:'UEL',f:'üèÜ',p:41},848:{n:'UECL',s:'UECL',f:'üèÜ',p:42}};
        const FETCH_L = [39,140,78,135,61,48,45,143,81,137,2,3,848,40,94,88,144,203,179,307];
        const MKT = {home:'Home',draw:'Draw',away:'Away',homeOrDraw:'1X',awayOrDraw:'X2',homeOrAway:'12',over05:'O0.5',over15:'O1.5',over25:'O2.5',over35:'O3.5',under15:'U1.5',under25:'U2.5',under35:'U3.5',bttsYes:'BTTS Y',bttsNo:'BTTS N'};
        const BKS = ['Coral','Bet365','Ladbrokes','William Hill','Paddy Power','Betfair','Pinnacle'];

        // State
        let db=null,uid=null,online=false,loading=false;
        let allFix=[],filtFix=[],oddsC={},slip=[],curLeague='all',selBet=null,selConf='med';
        let data = {
            startDate:"2025-12-15",
            currentBalance:384.42,
            bets:[
                {id:1,date:"2025-12-15",type:"single",legs:[{match:"Fenerbahce vs Konyaspor",selection:"Home Win",odds:1.2857,league:"Turkish Super Lig",market:"home"}],selection:"Fenerbahce Win",competition:"Turkish Super Lig",odds:1.2857,stake:200,confidence:"high",status:"won",finalScore:"4-0",day:1,returns:257.14,balanceAfter:257.14,targetForDay:240,vsTarget:17.14},
                {id:2,date:"2025-12-16",type:"double",legs:[{match:"Cardiff vs Chelsea",selection:"Away Win",odds:1.30,league:"EFL Cup",market:"away"},{match:"Guadalajara vs Barcelona",selection:"Away Win",odds:1.15,league:"Copa del Rey",market:"away"}],selection:"Chelsea + Barcelona",competition:"EFL Cup / Copa del Rey",odds:1.495,stake:257.14,confidence:"high",status:"won",finalScore:"1-5, 0-4",day:2,returns:384.42,balanceAfter:384.42,targetForDay:288,vsTarget:96.42}
            ],
            pendingBets:[],
            settings:{theme:'dark'},
            lastUpdated:Date.now()
        };

        // Utils
        const sleep = ms => new Promise(r=>setTimeout(r,ms));
        const today = () => new Date().toISOString().split('T')[0];
        const fmt = n => `¬£${n.toFixed(2)}`;
        const targ = d => INIT_BAL * Math.pow(MULT, d);

        function notify(m,t='info'){
            document.querySelectorAll('.notification').forEach(n=>n.remove());
            const el=document.createElement('div');
            el.className=`notification notification-${t}`;
            el.textContent=m;
            document.body.appendChild(el);
            setTimeout(()=>el.remove(),3000);
        }

        // Theme
        function toggleTheme(){
            const t = document.documentElement.getAttribute('data-theme')==='light'?'dark':'light';
            document.documentElement.setAttribute('data-theme',t);
            document.getElementById('themeBtn').textContent = t==='light'?'‚òÄÔ∏è':'üåô';
            localStorage.setItem('theme',t);
        }
        function loadTheme(){
            const t = localStorage.getItem('theme')||'dark';
            document.documentElement.setAttribute('data-theme',t);
            document.getElementById('themeBtn').textContent = t==='light'?'‚òÄÔ∏è':'üåô';
        }

        // Firebase
        function initFB(){
            try{
                firebase.initializeApp(FB_CFG);
                db = firebase.database();
                uid = localStorage.getItem('uid')||('u_'+Date.now());
                localStorage.setItem('uid',uid);
                
                db.ref(`c/${uid}`).on('value',s=>{
                    const d=s.val();
                    if(d && d.lastUpdated>(data.lastUpdated||0)){data=d;updateUI();}
                    online=true;
                    document.getElementById('fbDot').className='status-dot online';
                    document.getElementById('fbText').textContent='Synced';
                },()=>{
                    document.getElementById('fbDot').className='status-dot offline';
                    document.getElementById('fbText').textContent='Offline';
                });
            }catch(e){
                document.getElementById('fbDot').className='status-dot offline';
                document.getElementById('fbText').textContent='Error';
            }
        }

        function saveD(){
            data.lastUpdated=Date.now();
            localStorage.setItem('bd6',JSON.stringify(data));
            if(db&&uid&&online)db.ref(`c/${uid}`).set(data).catch(()=>{});
        }

        function loadD(){
            const s=localStorage.getItem('bd6');
            if(s)try{const p=JSON.parse(s);if(p.bets)data=p;}catch(e){}
            loadTheme();
            updateUI();
        }

        function exportD(){
            const b=new Blob([JSON.stringify(data,null,2)],{type:'application/json'});
            const a=document.createElement('a');
            a.href=URL.createObjectURL(b);
            a.download=`bet-${today()}.json`;
            a.click();
            notify('Exported!','success');
        }

        function importD(e){
            const f=e.target.files[0];
            if(f){
                const r=new FileReader();
                r.onload=ev=>{try{data=JSON.parse(ev.target.result);saveD();updateUI();notify('Imported!','success');}catch(err){notify('Failed','error');}};
                r.readAsText(f);
            }
            e.target.value='';
        }

        function resetD(){
            if(confirm('Reset ALL data?')){
                data={startDate:today(),currentBalance:INIT_BAL,bets:[],pendingBets:[],settings:{theme:'dark'},lastUpdated:Date.now()};
                saveD();updateUI();notify('Reset!','success');
            }
        }

        // API
        async function api(ep){
            try{
                const r=await fetch(`${API_BASE}${ep}`,{headers:{'x-apisports-key':API_KEY}});
                if(r.ok){const j=await r.json();return j.response||[];}
            }catch(e){}
            return [];
        }

        async function loadFixtures(){
            if(loading)return;
            loading=true;
            
            document.getElementById('apiDot').className='status-dot connecting';
            document.getElementById('apiText').textContent='Loading';
            document.getElementById('fixCont').innerHTML='<div class="loading"><div class="spinner"></div></div>';
            
            allFix=[];
            
            try{
                for(const l of FETCH_L){
                    const d=await api(`/fixtures?league=${l}&next=10`);
                    if(d.length)allFix.push(...d);
                    await sleep(100);
                }
                
                document.getElementById('apiText').textContent=allFix.length+' odds...';
                await loadOdds();
                
                document.getElementById('apiDot').className='status-dot online';
                document.getElementById('apiText').textContent=allFix.length+'';
                document.getElementById('fixCount').textContent=allFix.length+' fixtures';
            }catch(e){
                document.getElementById('apiDot').className='status-dot offline';
                document.getElementById('apiText').textContent='Error';
                document.getElementById('fixCont').innerHTML='<div class="empty-state"><div class="empty-state-icon">‚ö†Ô∏è</div><p>Load failed</p></div>';
            }
            
            filterFix();
            loading=false;
        }

        async function loadForDate(){
            const d=document.getElementById('dateF').value;
            if(!d){notify('Select date','warning');return;}
            if(loading)return;
            loading=true;
            
            document.getElementById('apiDot').className='status-dot connecting';
            document.getElementById('apiText').textContent='Loading';
            document.getElementById('fixCont').innerHTML='<div class="loading"><div class="spinner"></div></div>';
            
            allFix=[];
            
            try{
                for(const l of FETCH_L){
                    const r=await api(`/fixtures?league=${l}&date=${d}`);
                    if(r.length)allFix.push(...r);
                    await sleep(100);
                }
                
                document.getElementById('apiText').textContent=allFix.length+' odds...';
                await loadOdds();
                
                document.getElementById('apiDot').className='status-dot online';
                document.getElementById('apiText').textContent=allFix.length+'';
                document.getElementById('fixCount').textContent=allFix.length+' fixtures';
            }catch(e){
                document.getElementById('apiDot').className='status-dot offline';
                document.getElementById('apiText').textContent='Error';
                document.getElementById('fixCont').innerHTML='<div class="empty-state"><div class="empty-state-icon">‚ö†Ô∏è</div><p>Load failed</p></div>';
            }
            
            filterFix();
            loading=false;
        }

        async function loadOdds(){
            const grp={};
            allFix.forEach(f=>{
                const k=`${f.league.id}_${f.fixture.date.split('T')[0]}`;
                if(!grp[k])grp[k]={l:f.league.id,d:f.fixture.date.split('T')[0]};
            });
            
            for(const k of Object.keys(grp)){
                const{l,d}=grp[k];
                const r=await api(`/